Sending build context to Docker daemon  53.45MB
Step 1/12 : FROM nvcr.io/nvidia/cuda:11.6.2-base-ubuntu20.04
 ---> 2098e65daccd
Step 2/12 : WORKDIR /app
 ---> Using cache
 ---> 15db9de2454a
Step 3/12 : ENV DEBIAN_FRONTEND=noninteractive
 ---> Using cache
 ---> c97a7687ef83
Step 4/12 : ENV TZ=Europe/London
 ---> Using cache
 ---> 560c640e413a
Step 5/12 : RUN apt-get update && apt-get install -y     openslide-tools     python3     python3-pip     python3-openslide     expect     tzdata     git     ffmpeg &&     rm -rf /var/lib/apt/lists/*
 ---> Using cache
 ---> 10f9e3dc8123
Step 6/12 : RUN python3 --version && pip3 --version
 ---> Using cache
 ---> 0f5c4cf430b0
Step 7/12 : RUN pip3 install --upgrade cryptography pyopenssl
 ---> Using cache
 ---> e12552edfd8c
Step 8/12 : COPY requirements.txt /app/requirements.txt
 ---> Using cache
 ---> f091bf5b1665
Step 9/12 : RUN pip3 install -r /app/requirements.txt
 ---> Using cache
 ---> 3336a5843db4
Step 10/12 : RUN pip3 install torch==1.13.0 torchvision==0.14.0 --extra-index-url https://download.pytorch.org/whl/cu117
 ---> Using cache
 ---> 774ed22771cb
Step 11/12 : COPY . /app/ips_attention_masking
 ---> f003d61f1463
Step 12/12 : CMD ["bash"]
 ---> Running in a90a85a0853d
Removing intermediate container a90a85a0853d
 ---> 611cb99e0466
Successfully built 611cb99e0466
Successfully tagged my-custom-image:latest
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz
    8192/11490434 [..............................] - ETA: 0s   49152/11490434 [..............................] - ETA: 23s   81920/11490434 [..............................] - ETA: 25s  147456/11490434 [..............................] - ETA: 18s  212992/11490434 [..............................] - ETA: 15s  278528/11490434 [..............................] - ETA: 13s  507904/11490434 [>.............................] - ETA: 8s   794624/11490434 [=>............................] - ETA: 6s 1245184/11490434 [==>...........................] - ETA: 4s 1916928/11490434 [====>.........................] - ETA: 2s 2392064/11490434 [=====>........................] - ETA: 2s 3284992/11490434 [=======>......................] - ETA: 1s 4005888/11490434 [=========>....................] - ETA: 1s 4734976/11490434 [===========>..................] - ETA: 1s 5636096/11490434 [=============>................] - ETA: 0s 6348800/11490434 [===============>..............] - ETA: 0s 7061504/11490434 [=================>............] - ETA: 0s 7897088/11490434 [===================>..........] - ETA: 0s 8790016/11490434 [=====================>........] - ETA: 0s 9764864/11490434 [========================>.....] - ETA: 0s10747904/11490434 [===========================>..] - ETA: 0s11490434/11490434 [==============================] - 1s 0us/step
Sparsifying dataset
[1000DProcessing     1 /     32[1000DProcessing     2 /     32[1000DProcessing     3 /     32[1000DProcessing     4 /     32[1000DProcessing     5 /     32[1000DProcessing     6 /     32[1000DProcessing     7 /     32[1000DProcessing     8 /     32[1000DProcessing     9 /     32[1000DProcessing    10 /     32[1000DProcessing    11 /     32[1000DProcessing    12 /     32[1000DProcessing    13 /     32[1000DProcessing    14 /     32[1000DProcessing    15 /     32[1000DProcessing    16 /     32[1000DProcessing    17 /     32[1000DProcessing    18 /     32[1000DProcessing    19 /     32[1000DProcessing    20 /     32[1000DProcessing    21 /     32[1000DProcessing    22 /     32[1000DProcessing    23 /     32[1000DProcessing    24 /     32[1000DProcessing    25 /     32[1000DProcessing    26 /     32[1000DProcessing    27 /     32[1000DProcessing    28 /     32[1000DProcessing    29 /     32[1000DProcessing    30 /     32[1000DProcessing    31 /     32[1000DProcessing    32 /     32
Sparsifying dataset
[1000DProcessing     1 /   1000[1000DProcessing     2 /   1000[1000DProcessing     3 /   1000[1000DProcessing     4 /   1000[1000DProcessing     5 /   1000[1000DProcessing     6 /   1000[1000DProcessing     7 /   1000[1000DProcessing     8 /   1000[1000DProcessing     9 /   1000[1000DProcessing    10 /   1000[1000DProcessing    11 /   1000[1000DProcessing    12 /   1000[1000DProcessing    13 /   1000[1000DProcessing    14 /   1000[1000DProcessing    15 /   1000[1000DProcessing    16 /   1000[1000DProcessing    17 /   1000[1000DProcessing    18 /   1000[1000DProcessing    19 /   1000[1000DProcessing    20 /   1000[1000DProcessing    21 /   1000[1000DProcessing    22 /   1000[1000DProcessing    23 /   1000[1000DProcessing    24 /   1000[1000DProcessing    25 /   1000[1000DProcessing    26 /   1000[1000DProcessing    27 /   1000[1000DProcessing    28 /   1000[1000DProcessing    29 /   1000[1000DProcessing    30 /   1000[1000DProcessing    31 /   1000[1000DProcessing    32 /   1000[1000DProcessing    33 /   1000[1000DProcessing    34 /   1000[1000DProcessing    35 /   1000[1000DProcessing    36 /   1000[1000DProcessing    37 /   1000[1000DProcessing    38 /   1000[1000DProcessing    39 /   1000[1000DProcessing    40 /   1000[1000DProcessing    41 /   1000[1000DProcessing    42 /   1000[1000DProcessing    43 /   1000[1000DProcessing    44 /   1000[1000DProcessing    45 /   1000[1000DProcessing    46 /   1000[1000DProcessing    47 /   1000[1000DProcessing    48 /   1000[1000DProcessing    49 /   1000[1000DProcessing    50 /   1000[1000DProcessing    51 /   1000[1000DProcessing    52 /   1000[1000DProcessing    53 /   1000[1000DProcessing    54 /   1000[1000DProcessing    55 /   1000[1000DProcessing    56 /   1000[1000DProcessing    57 /   1000[1000DProcessing    58 /   1000[1000DProcessing    59 /   1000[1000DProcessing    60 /   1000[1000DProcessing    61 /   1000[1000DProcessing    62 /   1000[1000DProcessing    63 /   1000[1000DProcessing    64 /   1000[1000DProcessing    65 /   1000[1000DProcessing    66 /   1000[1000DProcessing    67 /   1000[1000DProcessing    68 /   1000[1000DProcessing    69 /   1000[1000DProcessing    70 /   1000[1000DProcessing    71 /   1000[1000DProcessing    72 /   1000[1000DProcessing    73 /   1000[1000DProcessing    74 /   1000[1000DProcessing    75 /   1000[1000DProcessing    76 /   1000[1000DProcessing    77 /   1000[1000DProcessing    78 /   1000[1000DProcessing    79 /   1000[1000DProcessing    80 /   1000[1000DProcessing    81 /   1000[1000DProcessing    82 /   1000[1000DProcessing    83 /   1000[1000DProcessing    84 /   1000[1000DProcessing    85 /   1000[1000DProcessing    86 /   1000[1000DProcessing    87 /   1000[1000DProcessing    88 /   1000[1000DProcessing    89 /   1000[1000DProcessing    90 /   1000[1000DProcessing    91 /   1000[1000DProcessing    92 /   1000[1000DProcessing    93 /   1000[1000DProcessing    94 /   1000[1000DProcessing    95 /   1000[1000DProcessing    96 /   1000[1000DProcessing    97 /   1000[1000DProcessing    98 /   1000[1000DProcessing    99 /   1000[1000DProcessing   100 /   1000[1000DProcessing   101 /   1000[1000DProcessing   102 /   1000[1000DProcessing   103 /   1000[1000DProcessing   104 /   1000[1000DProcessing   105 /   1000[1000DProcessing   106 /   1000[1000DProcessing   107 /   1000[1000DProcessing   108 /   1000[1000DProcessing   109 /   1000[1000DProcessing   110 /   1000[1000DProcessing   111 /   1000[1000DProcessing   112 /   1000[1000DProcessing   113 /   1000[1000DProcessing   114 /   1000[1000DProcessing   115 /   1000[1000DProcessing   116 /   1000[1000DProcessing   117 /   1000[1000DProcessing   118 /   1000[1000DProcessing   119 /   1000[1000DProcessing   120 /   1000[1000DProcessing   121 /   1000[1000DProcessing   122 /   1000[1000DProcessing   123 /   1000[1000DProcessing   124 /   1000[1000DProcessing   125 /   1000[1000DProcessing   126 /   1000[1000DProcessing   127 /   1000[1000DProcessing   128 /   1000[1000DProcessing   129 /   1000[1000DProcessing   130 /   1000[1000DProcessing   131 /   1000[1000DProcessing   132 /   1000[1000DProcessing   133 /   1000[1000DProcessing   134 /   1000[1000DProcessing   135 /   1000[1000DProcessing   136 /   1000[1000DProcessing   137 /   1000[1000DProcessing   138 /   1000[1000DProcessing   139 /   1000[1000DProcessing   140 /   1000[1000DProcessing   141 /   1000[1000DProcessing   142 /   1000[1000DProcessing   143 /   1000[1000DProcessing   144 /   1000[1000DProcessing   145 /   1000[1000DProcessing   146 /   1000[1000DProcessing   147 /   1000[1000DProcessing   148 /   1000[1000DProcessing   149 /   1000[1000DProcessing   150 /   1000[1000DProcessing   151 /   1000[1000DProcessing   152 /   1000[1000DProcessing   153 /   1000[1000DProcessing   154 /   1000[1000DProcessing   155 /   1000[1000DProcessing   156 /   1000[1000DProcessing   157 /   1000[1000DProcessing   158 /   1000[1000DProcessing   159 /   1000[1000DProcessing   160 /   1000[1000DProcessing   161 /   1000[1000DProcessing   162 /   1000[1000DProcessing   163 /   1000[1000DProcessing   164 /   1000[1000DProcessing   165 /   1000[1000DProcessing   166 /   1000[1000DProcessing   167 /   1000[1000DProcessing   168 /   1000[1000DProcessing   169 /   1000[1000DProcessing   170 /   1000[1000DProcessing   171 /   1000[1000DProcessing   172 /   1000[1000DProcessing   173 /   1000[1000DProcessing   174 /   1000[1000DProcessing   175 /   1000[1000DProcessing   176 /   1000[1000DProcessing   177 /   1000[1000DProcessing   178 /   1000[1000DProcessing   179 /   1000[1000DProcessing   180 /   1000[1000DProcessing   181 /   1000[1000DProcessing   182 /   1000[1000DProcessing   183 /   1000[1000DProcessing   184 /   1000[1000DProcessing   185 /   1000[1000DProcessing   186 /   1000[1000DProcessing   187 /   1000[1000DProcessing   188 /   1000[1000DProcessing   189 /   1000[1000DProcessing   190 /   1000[1000DProcessing   191 /   1000[1000DProcessing   192 /   1000[1000DProcessing   193 /   1000[1000DProcessing   194 /   1000[1000DProcessing   195 /   1000[1000DProcessing   196 /   1000[1000DProcessing   197 /   1000[1000DProcessing   198 /   1000[1000DProcessing   199 /   1000[1000DProcessing   200 /   1000[1000DProcessing   201 /   1000[1000DProcessing   202 /   1000[1000DProcessing   203 /   1000[1000DProcessing   204 /   1000[1000DProcessing   205 /   1000[1000DProcessing   206 /   1000[1000DProcessing   207 /   1000[1000DProcessing   208 /   1000[1000DProcessing   209 /   1000[1000DProcessing   210 /   1000[1000DProcessing   211 /   1000[1000DProcessing   212 /   1000[1000DProcessing   213 /   1000[1000DProcessing   214 /   1000[1000DProcessing   215 /   1000[1000DProcessing   216 /   1000[1000DProcessing   217 /   1000[1000DProcessing   218 /   1000[1000DProcessing   219 /   1000[1000DProcessing   220 /   1000[1000DProcessing   221 /   1000[1000DProcessing   222 /   1000[1000DProcessing   223 /   1000[1000DProcessing   224 /   1000[1000DProcessing   225 /   1000[1000DProcessing   226 /   1000[1000DProcessing   227 /   1000[1000DProcessing   228 /   1000[1000DProcessing   229 /   1000[1000DProcessing   230 /   1000[1000DProcessing   231 /   1000[1000DProcessing   232 /   1000[1000DProcessing   233 /   1000[1000DProcessing   234 /   1000[1000DProcessing   235 /   1000[1000DProcessing   236 /   1000[1000DProcessing   237 /   1000[1000DProcessing   238 /   1000[1000DProcessing   239 /   1000[1000DProcessing   240 /   1000[1000DProcessing   241 /   1000[1000DProcessing   242 /   1000[1000DProcessing   243 /   1000[1000DProcessing   244 /   1000[1000DProcessing   245 /   1000[1000DProcessing   246 /   1000[1000DProcessing   247 /   1000[1000DProcessing   248 /   1000[1000DProcessing   249 /   1000[1000DProcessing   250 /   1000[1000DProcessing   251 /   1000[1000DProcessing   252 /   1000[1000DProcessing   253 /   1000[1000DProcessing   254 /   1000[1000DProcessing   255 /   1000[1000DProcessing   256 /   1000[1000DProcessing   257 /   1000[1000DProcessing   258 /   1000[1000DProcessing   259 /   1000[1000DProcessing   260 /   1000[1000DProcessing   261 /   1000[1000DProcessing   262 /   1000[1000DProcessing   263 /   1000[1000DProcessing   264 /   1000[1000DProcessing   265 /   1000[1000DProcessing   266 /   1000[1000DProcessing   267 /   1000[1000DProcessing   268 /   1000[1000DProcessing   269 /   1000[1000DProcessing   270 /   1000[1000DProcessing   271 /   1000[1000DProcessing   272 /   1000[1000DProcessing   273 /   1000[1000DProcessing   274 /   1000[1000DProcessing   275 /   1000[1000DProcessing   276 /   1000[1000DProcessing   277 /   1000[1000DProcessing   278 /   1000[1000DProcessing   279 /   1000[1000DProcessing   280 /   1000[1000DProcessing   281 /   1000[1000DProcessing   282 /   1000[1000DProcessing   283 /   1000[1000DProcessing   284 /   1000[1000DProcessing   285 /   1000[1000DProcessing   286 /   1000[1000DProcessing   287 /   1000[1000DProcessing   288 /   1000[1000DProcessing   289 /   1000[1000DProcessing   290 /   1000[1000DProcessing   291 /   1000[1000DProcessing   292 /   1000[1000DProcessing   293 /   1000[1000DProcessing   294 /   1000[1000DProcessing   295 /   1000[1000DProcessing   296 /   1000[1000DProcessing   297 /   1000[1000DProcessing   298 /   1000[1000DProcessing   299 /   1000[1000DProcessing   300 /   1000[1000DProcessing   301 /   1000[1000DProcessing   302 /   1000[1000DProcessing   303 /   1000[1000DProcessing   304 /   1000[1000DProcessing   305 /   1000[1000DProcessing   306 /   1000[1000DProcessing   307 /   1000[1000DProcessing   308 /   1000[1000DProcessing   309 /   1000[1000DProcessing   310 /   1000[1000DProcessing   311 /   1000[1000DProcessing   312 /   1000[1000DProcessing   313 /   1000[1000DProcessing   314 /   1000[1000DProcessing   315 /   1000[1000DProcessing   316 /   1000[1000DProcessing   317 /   1000[1000DProcessing   318 /   1000[1000DProcessing   319 /   1000[1000DProcessing   320 /   1000[1000DProcessing   321 /   1000[1000DProcessing   322 /   1000[1000DProcessing   323 /   1000[1000DProcessing   324 /   1000[1000DProcessing   325 /   1000[1000DProcessing   326 /   1000[1000DProcessing   327 /   1000[1000DProcessing   328 /   1000[1000DProcessing   329 /   1000[1000DProcessing   330 /   1000[1000DProcessing   331 /   1000[1000DProcessing   332 /   1000[1000DProcessing   333 /   1000[1000DProcessing   334 /   1000[1000DProcessing   335 /   1000[1000DProcessing   336 /   1000[1000DProcessing   337 /   1000[1000DProcessing   338 /   1000[1000DProcessing   339 /   1000[1000DProcessing   340 /   1000[1000DProcessing   341 /   1000[1000DProcessing   342 /   1000[1000DProcessing   343 /   1000[1000DProcessing   344 /   1000[1000DProcessing   345 /   1000[1000DProcessing   346 /   1000[1000DProcessing   347 /   1000[1000DProcessing   348 /   1000[1000DProcessing   349 /   1000[1000DProcessing   350 /   1000[1000DProcessing   351 /   1000[1000DProcessing   352 /   1000[1000DProcessing   353 /   1000[1000DProcessing   354 /   1000[1000DProcessing   355 /   1000[1000DProcessing   356 /   1000[1000DProcessing   357 /   1000[1000DProcessing   358 /   1000[1000DProcessing   359 /   1000[1000DProcessing   360 /   1000[1000DProcessing   361 /   1000[1000DProcessing   362 /   1000[1000DProcessing   363 /   1000[1000DProcessing   364 /   1000[1000DProcessing   365 /   1000[1000DProcessing   366 /   1000[1000DProcessing   367 /   1000[1000DProcessing   368 /   1000[1000DProcessing   369 /   1000[1000DProcessing   370 /   1000[1000DProcessing   371 /   1000[1000DProcessing   372 /   1000[1000DProcessing   373 /   1000[1000DProcessing   374 /   1000[1000DProcessing   375 /   1000[1000DProcessing   376 /   1000[1000DProcessing   377 /   1000[1000DProcessing   378 /   1000[1000DProcessing   379 /   1000[1000DProcessing   380 /   1000[1000DProcessing   381 /   1000[1000DProcessing   382 /   1000[1000DProcessing   383 /   1000[1000DProcessing   384 /   1000[1000DProcessing   385 /   1000[1000DProcessing   386 /   1000[1000DProcessing   387 /   1000[1000DProcessing   388 /   1000[1000DProcessing   389 /   1000[1000DProcessing   390 /   1000[1000DProcessing   391 /   1000[1000DProcessing   392 /   1000[1000DProcessing   393 /   1000[1000DProcessing   394 /   1000[1000DProcessing   395 /   1000[1000DProcessing   396 /   1000[1000DProcessing   397 /   1000[1000DProcessing   398 /   1000[1000DProcessing   399 /   1000[1000DProcessing   400 /   1000[1000DProcessing   401 /   1000[1000DProcessing   402 /   1000[1000DProcessing   403 /   1000[1000DProcessing   404 /   1000[1000DProcessing   405 /   1000[1000DProcessing   406 /   1000[1000DProcessing   407 /   1000[1000DProcessing   408 /   1000[1000DProcessing   409 /   1000[1000DProcessing   410 /   1000[1000DProcessing   411 /   1000[1000DProcessing   412 /   1000[1000DProcessing   413 /   1000[1000DProcessing   414 /   1000[1000DProcessing   415 /   1000[1000DProcessing   416 /   1000[1000DProcessing   417 /   1000[1000DProcessing   418 /   1000[1000DProcessing   419 /   1000[1000DProcessing   420 /   1000[1000DProcessing   421 /   1000[1000DProcessing   422 /   1000[1000DProcessing   423 /   1000[1000DProcessing   424 /   1000[1000DProcessing   425 /   1000[1000DProcessing   426 /   1000[1000DProcessing   427 /   1000[1000DProcessing   428 /   1000[1000DProcessing   429 /   1000[1000DProcessing   430 /   1000[1000DProcessing   431 /   1000[1000DProcessing   432 /   1000[1000DProcessing   433 /   1000[1000DProcessing   434 /   1000[1000DProcessing   435 /   1000[1000DProcessing   436 /   1000[1000DProcessing   437 /   1000[1000DProcessing   438 /   1000[1000DProcessing   439 /   1000[1000DProcessing   440 /   1000[1000DProcessing   441 /   1000[1000DProcessing   442 /   1000[1000DProcessing   443 /   1000[1000DProcessing   444 /   1000[1000DProcessing   445 /   1000[1000DProcessing   446 /   1000[1000DProcessing   447 /   1000[1000DProcessing   448 /   1000[1000DProcessing   449 /   1000[1000DProcessing   450 /   1000[1000DProcessing   451 /   1000[1000DProcessing   452 /   1000[1000DProcessing   453 /   1000[1000DProcessing   454 /   1000[1000DProcessing   455 /   1000[1000DProcessing   456 /   1000[1000DProcessing   457 /   1000[1000DProcessing   458 /   1000[1000DProcessing   459 /   1000[1000DProcessing   460 /   1000[1000DProcessing   461 /   1000[1000DProcessing   462 /   1000[1000DProcessing   463 /   1000[1000DProcessing   464 /   1000[1000DProcessing   465 /   1000[1000DProcessing   466 /   1000[1000DProcessing   467 /   1000[1000DProcessing   468 /   1000[1000DProcessing   469 /   1000[1000DProcessing   470 /   1000[1000DProcessing   471 /   1000[1000DProcessing   472 /   1000[1000DProcessing   473 /   1000[1000DProcessing   474 /   1000[1000DProcessing   475 /   1000[1000DProcessing   476 /   1000[1000DProcessing   477 /   1000[1000DProcessing   478 /   1000[1000DProcessing   479 /   1000[1000DProcessing   480 /   1000[1000DProcessing   481 /   1000[1000DProcessing   482 /   1000[1000DProcessing   483 /   1000[1000DProcessing   484 /   1000[1000DProcessing   485 /   1000[1000DProcessing   486 /   1000[1000DProcessing   487 /   1000[1000DProcessing   488 /   1000[1000DProcessing   489 /   1000[1000DProcessing   490 /   1000[1000DProcessing   491 /   1000[1000DProcessing   492 /   1000[1000DProcessing   493 /   1000[1000DProcessing   494 /   1000[1000DProcessing   495 /   1000[1000DProcessing   496 /   1000[1000DProcessing   497 /   1000[1000DProcessing   498 /   1000[1000DProcessing   499 /   1000[1000DProcessing   500 /   1000[1000DProcessing   501 /   1000[1000DProcessing   502 /   1000[1000DProcessing   503 /   1000[1000DProcessing   504 /   1000[1000DProcessing   505 /   1000[1000DProcessing   506 /   1000[1000DProcessing   507 /   1000[1000DProcessing   508 /   1000[1000DProcessing   509 /   1000[1000DProcessing   510 /   1000[1000DProcessing   511 /   1000[1000DProcessing   512 /   1000[1000DProcessing   513 /   1000[1000DProcessing   514 /   1000[1000DProcessing   515 /   1000[1000DProcessing   516 /   1000[1000DProcessing   517 /   1000[1000DProcessing   518 /   1000[1000DProcessing   519 /   1000[1000DProcessing   520 /   1000[1000DProcessing   521 /   1000[1000DProcessing   522 /   1000[1000DProcessing   523 /   1000[1000DProcessing   524 /   1000[1000DProcessing   525 /   1000[1000DProcessing   526 /   1000[1000DProcessing   527 /   1000[1000DProcessing   528 /   1000[1000DProcessing   529 /   1000[1000DProcessing   530 /   1000[1000DProcessing   531 /   1000[1000DProcessing   532 /   1000[1000DProcessing   533 /   1000[1000DProcessing   534 /   1000[1000DProcessing   535 /   1000[1000DProcessing   536 /   1000[1000DProcessing   537 /   1000[1000DProcessing   538 /   1000[1000DProcessing   539 /   1000[1000DProcessing   540 /   1000[1000DProcessing   541 /   1000[1000DProcessing   542 /   1000[1000DProcessing   543 /   1000[1000DProcessing   544 /   1000[1000DProcessing   545 /   1000[1000DProcessing   546 /   1000[1000DProcessing   547 /   1000[1000DProcessing   548 /   1000[1000DProcessing   549 /   1000[1000DProcessing   550 /   1000[1000DProcessing   551 /   1000[1000DProcessing   552 /   1000[1000DProcessing   553 /   1000[1000DProcessing   554 /   1000[1000DProcessing   555 /   1000[1000DProcessing   556 /   1000[1000DProcessing   557 /   1000[1000DProcessing   558 /   1000[1000DProcessing   559 /   1000[1000DProcessing   560 /   1000[1000DProcessing   561 /   1000[1000DProcessing   562 /   1000[1000DProcessing   563 /   1000[1000DProcessing   564 /   1000[1000DProcessing   565 /   1000[1000DProcessing   566 /   1000[1000DProcessing   567 /   1000[1000DProcessing   568 /   1000[1000DProcessing   569 /   1000[1000DProcessing   570 /   1000[1000DProcessing   571 /   1000[1000DProcessing   572 /   1000[1000DProcessing   573 /   1000[1000DProcessing   574 /   1000[1000DProcessing   575 /   1000[1000DProcessing   576 /   1000[1000DProcessing   577 /   1000[1000DProcessing   578 /   1000[1000DProcessing   579 /   1000[1000DProcessing   580 /   1000[1000DProcessing   581 /   1000[1000DProcessing   582 /   1000[1000DProcessing   583 /   1000[1000DProcessing   584 /   1000[1000DProcessing   585 /   1000[1000DProcessing   586 /   1000[1000DProcessing   587 /   1000[1000DProcessing   588 /   1000[1000DProcessing   589 /   1000[1000DProcessing   590 /   1000[1000DProcessing   591 /   1000[1000DProcessing   592 /   1000[1000DProcessing   593 /   1000[1000DProcessing   594 /   1000[1000DProcessing   595 /   1000[1000DProcessing   596 /   1000[1000DProcessing   597 /   1000[1000DProcessing   598 /   1000[1000DProcessing   599 /   1000[1000DProcessing   600 /   1000[1000DProcessing   601 /   1000[1000DProcessing   602 /   1000[1000DProcessing   603 /   1000[1000DProcessing   604 /   1000[1000DProcessing   605 /   1000[1000DProcessing   606 /   1000[1000DProcessing   607 /   1000[1000DProcessing   608 /   1000[1000DProcessing   609 /   1000[1000DProcessing   610 /   1000[1000DProcessing   611 /   1000[1000DProcessing   612 /   1000[1000DProcessing   613 /   1000[1000DProcessing   614 /   1000[1000DProcessing   615 /   1000[1000DProcessing   616 /   1000[1000DProcessing   617 /   1000[1000DProcessing   618 /   1000[1000DProcessing   619 /   1000[1000DProcessing   620 /   1000[1000DProcessing   621 /   1000[1000DProcessing   622 /   1000[1000DProcessing   623 /   1000[1000DProcessing   624 /   1000[1000DProcessing   625 /   1000[1000DProcessing   626 /   1000[1000DProcessing   627 /   1000[1000DProcessing   628 /   1000[1000DProcessing   629 /   1000[1000DProcessing   630 /   1000[1000DProcessing   631 /   1000[1000DProcessing   632 /   1000[1000DProcessing   633 /   1000[1000DProcessing   634 /   1000[1000DProcessing   635 /   1000[1000DProcessing   636 /   1000[1000DProcessing   637 /   1000[1000DProcessing   638 /   1000[1000DProcessing   639 /   1000[1000DProcessing   640 /   1000[1000DProcessing   641 /   1000[1000DProcessing   642 /   1000[1000DProcessing   643 /   1000[1000DProcessing   644 /   1000[1000DProcessing   645 /   1000[1000DProcessing   646 /   1000[1000DProcessing   647 /   1000[1000DProcessing   648 /   1000[1000DProcessing   649 /   1000[1000DProcessing   650 /   1000[1000DProcessing   651 /   1000[1000DProcessing   652 /   1000[1000DProcessing   653 /   1000[1000DProcessing   654 /   1000[1000DProcessing   655 /   1000[1000DProcessing   656 /   1000[1000DProcessing   657 /   1000[1000DProcessing   658 /   1000[1000DProcessing   659 /   1000[1000DProcessing   660 /   1000[1000DProcessing   661 /   1000[1000DProcessing   662 /   1000[1000DProcessing   663 /   1000[1000DProcessing   664 /   1000[1000DProcessing   665 /   1000[1000DProcessing   666 /   1000[1000DProcessing   667 /   1000[1000DProcessing   668 /   1000[1000DProcessing   669 /   1000[1000DProcessing   670 /   1000[1000DProcessing   671 /   1000[1000DProcessing   672 /   1000[1000DProcessing   673 /   1000[1000DProcessing   674 /   1000[1000DProcessing   675 /   1000[1000DProcessing   676 /   1000[1000DProcessing   677 /   1000[1000DProcessing   678 /   1000[1000DProcessing   679 /   1000[1000DProcessing   680 /   1000[1000DProcessing   681 /   1000[1000DProcessing   682 /   1000[1000DProcessing   683 /   1000[1000DProcessing   684 /   1000[1000DProcessing   685 /   1000[1000DProcessing   686 /   1000[1000DProcessing   687 /   1000[1000DProcessing   688 /   1000[1000DProcessing   689 /   1000[1000DProcessing   690 /   1000[1000DProcessing   691 /   1000[1000DProcessing   692 /   1000[1000DProcessing   693 /   1000[1000DProcessing   694 /   1000[1000DProcessing   695 /   1000[1000DProcessing   696 /   1000[1000DProcessing   697 /   1000[1000DProcessing   698 /   1000[1000DProcessing   699 /   1000[1000DProcessing   700 /   1000[1000DProcessing   701 /   1000[1000DProcessing   702 /   1000[1000DProcessing   703 /   1000[1000DProcessing   704 /   1000[1000DProcessing   705 /   1000[1000DProcessing   706 /   1000[1000DProcessing   707 /   1000[1000DProcessing   708 /   1000[1000DProcessing   709 /   1000[1000DProcessing   710 /   1000[1000DProcessing   711 /   1000[1000DProcessing   712 /   1000[1000DProcessing   713 /   1000[1000DProcessing   714 /   1000[1000DProcessing   715 /   1000[1000DProcessing   716 /   1000[1000DProcessing   717 /   1000[1000DProcessing   718 /   1000[1000DProcessing   719 /   1000[1000DProcessing   720 /   1000[1000DProcessing   721 /   1000[1000DProcessing   722 /   1000[1000DProcessing   723 /   1000[1000DProcessing   724 /   1000[1000DProcessing   725 /   1000[1000DProcessing   726 /   1000[1000DProcessing   727 /   1000[1000DProcessing   728 /   1000[1000DProcessing   729 /   1000[1000DProcessing   730 /   1000[1000DProcessing   731 /   1000[1000DProcessing   732 /   1000[1000DProcessing   733 /   1000[1000DProcessing   734 /   1000[1000DProcessing   735 /   1000[1000DProcessing   736 /   1000[1000DProcessing   737 /   1000[1000DProcessing   738 /   1000[1000DProcessing   739 /   1000[1000DProcessing   740 /   1000[1000DProcessing   741 /   1000[1000DProcessing   742 /   1000[1000DProcessing   743 /   1000[1000DProcessing   744 /   1000[1000DProcessing   745 /   1000[1000DProcessing   746 /   1000[1000DProcessing   747 /   1000[1000DProcessing   748 /   1000[1000DProcessing   749 /   1000[1000DProcessing   750 /   1000[1000DProcessing   751 /   1000[1000DProcessing   752 /   1000[1000DProcessing   753 /   1000[1000DProcessing   754 /   1000[1000DProcessing   755 /   1000[1000DProcessing   756 /   1000[1000DProcessing   757 /   1000[1000DProcessing   758 /   1000[1000DProcessing   759 /   1000[1000DProcessing   760 /   1000[1000DProcessing   761 /   1000[1000DProcessing   762 /   1000[1000DProcessing   763 /   1000[1000DProcessing   764 /   1000[1000DProcessing   765 /   1000[1000DProcessing   766 /   1000[1000DProcessing   767 /   1000[1000DProcessing   768 /   1000[1000DProcessing   769 /   1000[1000DProcessing   770 /   1000[1000DProcessing   771 /   1000[1000DProcessing   772 /   1000[1000DProcessing   773 /   1000[1000DProcessing   774 /   1000[1000DProcessing   775 /   1000[1000DProcessing   776 /   1000[1000DProcessing   777 /   1000[1000DProcessing   778 /   1000[1000DProcessing   779 /   1000[1000DProcessing   780 /   1000[1000DProcessing   781 /   1000[1000DProcessing   782 /   1000[1000DProcessing   783 /   1000[1000DProcessing   784 /   1000[1000DProcessing   785 /   1000[1000DProcessing   786 /   1000[1000DProcessing   787 /   1000[1000DProcessing   788 /   1000[1000DProcessing   789 /   1000[1000DProcessing   790 /   1000[1000DProcessing   791 /   1000[1000DProcessing   792 /   1000[1000DProcessing   793 /   1000[1000DProcessing   794 /   1000[1000DProcessing   795 /   1000[1000DProcessing   796 /   1000[1000DProcessing   797 /   1000[1000DProcessing   798 /   1000[1000DProcessing   799 /   1000[1000DProcessing   800 /   1000[1000DProcessing   801 /   1000[1000DProcessing   802 /   1000[1000DProcessing   803 /   1000[1000DProcessing   804 /   1000[1000DProcessing   805 /   1000[1000DProcessing   806 /   1000[1000DProcessing   807 /   1000[1000DProcessing   808 /   1000[1000DProcessing   809 /   1000[1000DProcessing   810 /   1000[1000DProcessing   811 /   1000[1000DProcessing   812 /   1000[1000DProcessing   813 /   1000[1000DProcessing   814 /   1000[1000DProcessing   815 /   1000[1000DProcessing   816 /   1000[1000DProcessing   817 /   1000[1000DProcessing   818 /   1000[1000DProcessing   819 /   1000[1000DProcessing   820 /   1000[1000DProcessing   821 /   1000[1000DProcessing   822 /   1000[1000DProcessing   823 /   1000[1000DProcessing   824 /   1000[1000DProcessing   825 /   1000[1000DProcessing   826 /   1000[1000DProcessing   827 /   1000[1000DProcessing   828 /   1000[1000DProcessing   829 /   1000[1000DProcessing   830 /   1000[1000DProcessing   831 /   1000[1000DProcessing   832 /   1000[1000DProcessing   833 /   1000[1000DProcessing   834 /   1000[1000DProcessing   835 /   1000[1000DProcessing   836 /   1000[1000DProcessing   837 /   1000[1000DProcessing   838 /   1000[1000DProcessing   839 /   1000[1000DProcessing   840 /   1000[1000DProcessing   841 /   1000[1000DProcessing   842 /   1000[1000DProcessing   843 /   1000[1000DProcessing   844 /   1000[1000DProcessing   845 /   1000[1000DProcessing   846 /   1000[1000DProcessing   847 /   1000[1000DProcessing   848 /   1000[1000DProcessing   849 /   1000[1000DProcessing   850 /   1000[1000DProcessing   851 /   1000[1000DProcessing   852 /   1000[1000DProcessing   853 /   1000[1000DProcessing   854 /   1000[1000DProcessing   855 /   1000[1000DProcessing   856 /   1000[1000DProcessing   857 /   1000[1000DProcessing   858 /   1000[1000DProcessing   859 /   1000[1000DProcessing   860 /   1000[1000DProcessing   861 /   1000[1000DProcessing   862 /   1000[1000DProcessing   863 /   1000[1000DProcessing   864 /   1000[1000DProcessing   865 /   1000[1000DProcessing   866 /   1000[1000DProcessing   867 /   1000[1000DProcessing   868 /   1000[1000DProcessing   869 /   1000[1000DProcessing   870 /   1000[1000DProcessing   871 /   1000[1000DProcessing   872 /   1000[1000DProcessing   873 /   1000[1000DProcessing   874 /   1000[1000DProcessing   875 /   1000[1000DProcessing   876 /   1000[1000DProcessing   877 /   1000[1000DProcessing   878 /   1000[1000DProcessing   879 /   1000[1000DProcessing   880 /   1000[1000DProcessing   881 /   1000[1000DProcessing   882 /   1000[1000DProcessing   883 /   1000[1000DProcessing   884 /   1000[1000DProcessing   885 /   1000[1000DProcessing   886 /   1000[1000DProcessing   887 /   1000[1000DProcessing   888 /   1000[1000DProcessing   889 /   1000[1000DProcessing   890 /   1000[1000DProcessing   891 /   1000[1000DProcessing   892 /   1000[1000DProcessing   893 /   1000[1000DProcessing   894 /   1000[1000DProcessing   895 /   1000[1000DProcessing   896 /   1000[1000DProcessing   897 /   1000[1000DProcessing   898 /   1000[1000DProcessing   899 /   1000[1000DProcessing   900 /   1000[1000DProcessing   901 /   1000[1000DProcessing   902 /   1000[1000DProcessing   903 /   1000[1000DProcessing   904 /   1000[1000DProcessing   905 /   1000[1000DProcessing   906 /   1000[1000DProcessing   907 /   1000[1000DProcessing   908 /   1000[1000DProcessing   909 /   1000[1000DProcessing   910 /   1000[1000DProcessing   911 /   1000[1000DProcessing   912 /   1000[1000DProcessing   913 /   1000[1000DProcessing   914 /   1000[1000DProcessing   915 /   1000[1000DProcessing   916 /   1000[1000DProcessing   917 /   1000[1000DProcessing   918 /   1000[1000DProcessing   919 /   1000[1000DProcessing   920 /   1000[1000DProcessing   921 /   1000[1000DProcessing   922 /   1000[1000DProcessing   923 /   1000[1000DProcessing   924 /   1000[1000DProcessing   925 /   1000[1000DProcessing   926 /   1000[1000DProcessing   927 /   1000[1000DProcessing   928 /   1000[1000DProcessing   929 /   1000[1000DProcessing   930 /   1000[1000DProcessing   931 /   1000[1000DProcessing   932 /   1000[1000DProcessing   933 /   1000[1000DProcessing   934 /   1000[1000DProcessing   935 /   1000[1000DProcessing   936 /   1000[1000DProcessing   937 /   1000[1000DProcessing   938 /   1000[1000DProcessing   939 /   1000[1000DProcessing   940 /   1000[1000DProcessing   941 /   1000[1000DProcessing   942 /   1000[1000DProcessing   943 /   1000[1000DProcessing   944 /   1000[1000DProcessing   945 /   1000[1000DProcessing   946 /   1000[1000DProcessing   947 /   1000[1000DProcessing   948 /   1000[1000DProcessing   949 /   1000[1000DProcessing   950 /   1000[1000DProcessing   951 /   1000[1000DProcessing   952 /   1000[1000DProcessing   953 /   1000[1000DProcessing   954 /   1000[1000DProcessing   955 /   1000[1000DProcessing   956 /   1000[1000DProcessing   957 /   1000[1000DProcessing   958 /   1000[1000DProcessing   959 /   1000[1000DProcessing   960 /   1000[1000DProcessing   961 /   1000[1000DProcessing   962 /   1000[1000DProcessing   963 /   1000[1000DProcessing   964 /   1000[1000DProcessing   965 /   1000[1000DProcessing   966 /   1000[1000DProcessing   967 /   1000[1000DProcessing   968 /   1000[1000DProcessing   969 /   1000[1000DProcessing   970 /   1000[1000DProcessing   971 /   1000[1000DProcessing   972 /   1000[1000DProcessing   973 /   1000[1000DProcessing   974 /   1000[1000DProcessing   975 /   1000[1000DProcessing   976 /   1000[1000DProcessing   977 /   1000[1000DProcessing   978 /   1000[1000DProcessing   979 /   1000[1000DProcessing   980 /   1000[1000DProcessing   981 /   1000[1000DProcessing   982 /   1000[1000DProcessing   983 /   1000[1000DProcessing   984 /   1000[1000DProcessing   985 /   1000[1000DProcessing   986 /   1000[1000DProcessing   987 /   1000[1000DProcessing   988 /   1000[1000DProcessing   989 /   1000[1000DProcessing   990 /   1000[1000DProcessing   991 /   1000[1000DProcessing   992 /   1000[1000DProcessing   993 /   1000[1000DProcessing   994 /   1000[1000DProcessing   995 /   1000[1000DProcessing   996 /   1000[1000DProcessing   997 /   1000[1000DProcessing   998 /   1000[1000DProcessing   999 /   1000[1000DProcessing  1000 /   1000
Used config:
{'B': 16,
 'B_seq': 16,
 'D': 128,
 'D_inner': 512,
 'D_k': 16,
 'D_v': 16,
 'H': 8,
 'I': 100,
 'M': 100,
 'N': 900,
 'attn_dropout': 0,
 'data_dir': 'data/megapixel_mnist/dsets/megapixel_mnist_1500',
 'dropout': 0,
 'eager': True,
 'enc_type': 'resnet18',
 'eps': 1e-06,
 'is_image': True,
 'lr': 0.001,
 'mask_K': 10,
 'mask_p': 0.4,
 'n_chan_in': 1,
 'n_class': 10,
 'n_epoch': 3,
 'n_epoch_warmup': 1,
 'n_res_blocks': 2,
 'n_token': 4,
 'n_worker': 8,
 'patch_size': [50, 50],
 'patch_stride': [50, 50],
 'pin_memory': True,
 'pretrained': False,
 'seed': 0,
 'shuffle': True,
 'shuffle_style': 'batch',
 'tasks': {'task0': {'act_fn': 'softmax',
                     'id': 0,
                     'metric': 'accuracy',
                     'name': 'majority'},
           'task1': {'act_fn': 'softmax',
                     'id': 1,
                     'metric': 'accuracy',
                     'name': 'max'},
           'task2': {'act_fn': 'softmax',
                     'id': 2,
                     'metric': 'accuracy',
                     'name': 'top'},
           'task3': {'act_fn': 'sigmoid',
                     'id': 3,
                     'metric': 'multilabel_accuracy',
                     'name': 'multi'}},
 'track_efficiency': False,
 'track_epoch': 0,
 'use_pos': True,
 'wd': 0.1}
Train Epoch: 1 
task: majority, mean loss: 2.40932, accuracy: 0.12500, task: max, mean loss: 2.34953, accuracy: 0.09375, task: top, mean loss: 2.50731, accuracy: 0.09375, task: multi, mean loss: 0.71362, multilabel_accuracy: 0.00000, avg. loss over tasks: 1.99495, lr: 0.001

